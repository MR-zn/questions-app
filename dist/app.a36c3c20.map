{"version":3,"sources":["js\\app.js"],"names":["$","owner","login","loginInfo","callback","token","plus","nativeUI","showWaiting","mui","ajax","url","data","api_token","dataType","type","timeout","success","toMain","error","xhr","errorThrown","app","setState","closeWaiting","toast","sw","pwdBox","classList","contains","api","noop","account","password","checkPhone","accountBox","document","getElementById","passwordBox","codeBox","length","phone","status","createState","value","message","checkCode","code","state","getState","reg","regInfo","checkPwd","pwd","webview","currentWebview","close","stateText","localStorage","getItem","JSON","parse","setItem","stringify","settings","getSettings","gestures","setSettings","forgetPassword","newPwd","id","getLaunchWebview","show","settingsText","isInstalled","os","android","main","runtimeMainActivity","packageManager","getPackageManager","PackageManager","importClass","packageName","getPackageInfo","GET_ACTIVITIES","e","TencentOAuth","ios","import","iphoneQQInstalled","WXApi","isWXAppInstalled","SinaAPI","isWeiboAppInstalled","window"],"mappings":"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","file":"app.a36c3c20.map","sourceRoot":"..","sourcesContent":["/**\n * 演示程序当前的 “注册/登录” 等操作，是基于 “本地存储” 完成的\n * 当您要参考这个演示程序进行相关 app 的开发时，\n * 请注意将相关方法调整成 “基于服务端Service” 的实现。\n **/\n(function($, owner) {\n  /**\n\t * 用户登录\n\t **/\n  owner.login = function(loginInfo, callback) {\n    if (loginInfo.token != null) {\n      plus.nativeUI.showWaiting('加载中...')\n      mui.ajax(url + '/user/info', {\n        data: {\n          api_token: loginInfo.token\n        },\n        dataType: 'json',\n        type: 'get',\n        timeout: 10000,\n        success: function(data) {\n          toMain()\n        },\n        error: function(xhr, type, errorThrown) {\n          app.setState({})\n          plus.nativeUI.closeWaiting()\n          plus.nativeUI.toast('自动登录失败，请重新登录')\n        }\n      })\n      //\t\t\ttoMain();\n      return false\n    }\n    sw = !!pwdBox.classList.contains('mui-hidden')\n    api = sw ? url + '/login/sms' : url + '/login'\n    callback = callback || $.noop\n    loginInfo = loginInfo || {}\n    loginInfo.account = loginInfo.account || ''\n    loginInfo.password = loginInfo.password || ''\n    if (!checkPhone(loginInfo.account)) {\n      return callback('手机号格式错误！')\n    }\n\n    plus.nativeUI.showWaiting('登录中...')\n    var accountBox = document.getElementById('account')\n\n    var passwordBox = document.getElementById('password')\n\n    var codeBox = document.getElementById('code')\n\n    if (!sw) { // 密码登录\n      if (loginInfo.password.length < 6) {\n        plus.nativeUI.closeWaiting()\n        return callback('密码最短为 6 个字符')\n      }\n      mui.ajax(url + '/login', {\n        data: {\n          phone: loginInfo.account,\n          password: loginInfo.password\n        },\n        dataType: 'json',\n        type: 'post',\n        timeout: 10000,\n        success: function(data) {\n          plus.nativeUI.closeWaiting()\n\n          if (data.status == 0) {\n            app.createState(data.data.api_token, function() {\n              toMain()\n            })\n            accountBox.value = ''\n            passwordBox.value = ''\n            return callback('登录成功！')\n          } else {\n            return callback(data.message)\n          }\n        },\n        error: function(xhr, type, errorThrown) {\n          plus.nativeUI.closeWaiting()\n          return callback('密码登录失败')\n        }\n      })\n    } else { // 验证码登录\n      if (checkCode(loginInfo.code)) {\n        plus.nativeUI.closeWaiting()\n        return callback('请填写验证码！')\n      }\n      mui.ajax(url + '/login/sms', {\n        data: {\n          phone: loginInfo.account,\n          code: loginInfo.code\n        },\n        dataType: 'json',\n        type: 'post',\n        timeout: 5000,\n        success: function(data) {\n          plus.nativeUI.closeWaiting()\n          if (data.status == 0) {\n            app.createState(data.data.api_token, function() {\n              toMain()\n            })\n            accountBox.value = ''\n            codeBox.value = ''\n            return callback('登录成功！')\n          } else {\n            return callback(data.message)\n          }\n        },\n        error: function(xhr, type, errorThrown) {\n          plus.nativeUI.closeWaiting()\n          return callback('短信登录失败')\n        }\n      })\n    }\n\n    //\n    //\t\tvar token = JSON.parse(localStorage.getItem('$users') || '[]');\n    //\t\tusers.push(regInfo);\n    //\t\tlocalStorage.setItem('$users', JSON.stringify(users));\n  }\n\n  owner.createState = function(token, callback) {\n    var state = owner.getState()\n    state.token = token\n    owner.setState(state)\n    return callback()\n  }\n\n  /**\n\t * 新用户注册\n\t **/\n  owner.reg = function(regInfo, callback) {\n    callback = callback || $.noop\n    regInfo = regInfo || {}\n    regInfo.account = regInfo.account || ''\n    regInfo.password = regInfo.password || ''\n    if (!checkPhone(regInfo.account)) {\n      return callback('手机号格式有误！')\n    }\n    if (checkCode(regInfo.code)) {\n      return callback('请填写验证码！')\n    }\n    if (!checkPwd(regInfo.pwd)) {\n      return callback('只允许以大小写字母开头，可包含数字及(_.@)！')\n    }\n    plus.nativeUI.showWaiting('waitng...')\n\n    mui.ajax(url + '/register', {\n      data: {\n        code: regInfo.code,\n        phone: regInfo.account,\n        password: regInfo.pwd\n      },\n      dataType: 'json',\n      type: 'post',\n      timeout: 10000,\n      success: function(data) {\n        plus.nativeUI.closeWaiting()\n\n        if (data.status == 0) {\n          //\t\t\t\t\tplus.webview.getLaunchWebview().show(\"fade-in\",200,function () {\n          plus.webview.currentWebview().close('fade-out')\n          //\t\t\t\t\t});\n          return callback('注册成功！')\n        } else {\n          return callback(data.message)\n        }\n\n        return callback(1)\n      },\n      error: function(xhr, type, errorThrown) {\n        plus.nativeUI.closeWaiting()\n        return callback('注册失败！')\n      }\n    })\n\n    //\t\tvar users = JSON.parse(localStorage.getItem('$users') || '[]');\n    //\t\tusers.push(regInfo);\n    //\t\tlocalStorage.setItem('$users', JSON.stringify(users));\n    //\t\treturn callback('注册成功！');\n  }\n\n  /**\n\t * 获取当前状态\n\t **/\n  owner.getState = function() {\n    var stateText = localStorage.getItem('$state') || '{}'\n    return JSON.parse(stateText)\n  }\n\n  /**\n\t * 设置当前状态\n\t **/\n  owner.setState = function(state) {\n    state = state || {}\n    localStorage.setItem('$state', JSON.stringify(state))\n    var settings = owner.getSettings()\n    settings.gestures = ''\n    owner.setSettings(settings)\n  }\n\n  /**\n\t * 找回密码\n\t **/\n  owner.forgetPassword = function(regInfo, callback) {\n    callback = callback || $.noop\n    if (!checkPhone(regInfo.account)) {\n      return callback('手机号格式有误！')\n    }\n    if (checkCode(regInfo.code)) {\n      return callback('请填写验证码！')\n    }\n    if (!checkPwd(regInfo.newPwd)) {\n      return callback('只允许以大小写字母开头，可包含数字及(_.@)！')\n    }\n\n    plus.nativeUI.showWaiting('waitng...')\n\n    if (regInfo.id == 'forget') {\n      mui.ajax(url + '/user/forgotpassword', {\n        data: {\n          code: regInfo.code,\n          phone: regInfo.account,\n          password: regInfo.newPwd\n        },\n        dataType: 'json',\n        type: 'post',\n        timeout: 10000,\n        success: function(data) {\n          plus.nativeUI.closeWaiting()\n\n          if (data.status == 0) {\n            account.value = ''\n            code.value = ''\n            newPwd.value = ''\n            mui.currentWebview.close()\n            return callback('密码修改成功！!!!')\n          } else {\n            return callback(data.message)\n          }\n        },\n        error: function(status) {\n          plus.nativeUI.closeWaiting()\n          return callback('密码修改失败！')\n        }\n      })\n    } else if (regInfo.id == 'reset') {\n      mui.ajax(url + '/user/resetpassword', {\n        data: {\n          api_token: regInfo.token,\n          code: regInfo.code,\n          phone: regInfo.account,\n          password: regInfo.newPwd\n        },\n        dataType: 'json',\n        type: 'post',\n        timeout: 10000,\n        success: function(data) {\n          plus.nativeUI.closeWaiting()\n\n          if (data.status == 0) {\n            account.value = ''\n            code.value = ''\n            newPwd.value = ''\n            app.setState({})\n            plus.webview.getLaunchWebview().show('pop-in')\n            return callback('密码修改成功！!!!')\n          } else {\n            return callback(data.message)\n          }\n        },\n        error: function(status) {\n          plus.nativeUI.closeWaiting()\n          return callback('密码修改失败！')\n        }\n      })\n    }\n  }\n\n  /**\n\t * 获取应用本地配置\n\t **/\n  owner.setSettings = function(settings) {\n    settings = settings || {}\n    localStorage.setItem('$settings', JSON.stringify(settings))\n  }\n\n  /**\n\t * 设置应用本地配置\n\t **/\n  owner.getSettings = function() {\n    var settingsText = localStorage.getItem('$settings') || '{}'\n    return JSON.parse(settingsText)\n  }\n  /**\n\t * 获取本地是否安装客户端\n\t **/\n  owner.isInstalled = function(id) {\n    if (id === 'qihoo' && mui.os.plus) {\n      return true\n    }\n    if (mui.os.android) {\n      var main = plus.android.runtimeMainActivity()\n      var packageManager = main.getPackageManager()\n      var PackageManager = plus.android.importClass(packageManager)\n      var packageName = {\n        'qq': 'com.tencent.mobileqq',\n        'weixin': 'com.tencent.mm',\n        'sinaweibo': 'com.sina.weibo'\n      }\n      try {\n        return packageManager.getPackageInfo(packageName[id], PackageManager.GET_ACTIVITIES)\n      } catch (e) {}\n    } else {\n      switch (id) {\n        case 'qq':\n          var TencentOAuth = plus.ios.import('TencentOAuth')\n          return TencentOAuth.iphoneQQInstalled()\n        case 'weixin':\n          var WXApi = plus.ios.import('WXApi')\n          return WXApi.isWXAppInstalled()\n        case 'sinaweibo':\n          var SinaAPI = plus.ios.import('WeiboSDK')\n          return SinaAPI.isWeiboAppInstalled()\n        default:\n          break\n      }\n    }\n  }\n}(mui, window.app = {}))\n"]}