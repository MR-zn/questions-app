{"version":3,"sources":["js\\ranking\\index.js"],"names":["pullfresh","setTimeout","mui","pullRefresh","endPulldownToRefresh","toast","rank","document","querySelector","bodyH","body","offsetHeight","headerH","categoryH","rankH","style","height","aBtns","TabSwitch","id","obj","activeNum","querySelectorAll","a","len","length","_this","i","index","onclick","tab","getList","prototype","aBtn","className","mask","createMask","plus","nativeUI","showWaiting","loadrank","showRank","data","userRank","allRank","showLen","myRank","my","innerHTML","closeWaiting","myphone","phone","myscore","sum_score","myrank","html","score","classList","remove"],"mappings":"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","file":"ranking.78ea0bd8.map","sourceRoot":"..","sourcesContent":["//下拉刷新\r\n\r\nfunction pullfresh(){\r\n\tsetTimeout(function(){\r\n\t\t//业务逻辑\r\n\t\t\r\n\t\t\r\n\t\tmui('#rank').pullRefresh().endPulldownToRefresh();\r\n\t\tmui.toast('刷新成功');\r\n\t},1000)\r\n}\r\n\r\n\r\n//\r\nvar rank = document.querySelector('#rank'),\r\n\tbodyH = document.body.offsetHeight,\r\n\theaderH = document.querySelector('.header').offsetHeight,\r\n\tcategoryH = document.querySelector('.category').offsetHeight,\r\n\trankH = rank.offsetHeight;\r\n\trank.style.height = bodyH - headerH - categoryH + 'px';\r\n\r\n\r\nvar aBtns = null;\r\nfunction TabSwitch(id){\r\n    var obj = document.querySelector(id);\r\n    this.activeNum = 0;//当前活动的按钮\r\n    this.aBtns = obj.querySelectorAll('li');//全局变量 转变成属性\r\n    this.a = obj.querySelectorAll('a');\r\n    this.len = this.aBtns.length;\r\n    var _this =this;//将这里的对象this存入_this中，方便在按钮点击里面用\r\n    for(i=0;i<this.len;i++){\r\n        this.aBtns[i].index = i;\r\n        this.aBtns[i].onclick = function () {\r\n            _this.tab(this);//这里的this指的是按钮，把它作为参数传到函数中；\r\n            _this.getList(this.index);\r\n    \t\t_this.activeNum = this.index;\r\n        } \r\n    }\r\n}\r\nTabSwitch.prototype.tab = function (aBtn){//函数 转变成对象的方法\r\n    for(i=0;i<this.len;i++){\r\n        this.a[i].className = '';\r\n    }\r\n    aBtn.querySelector('a').className = 'active';\r\n}\r\n\r\n//请求数据\r\nvar mask=mui.createMask();\r\nTabSwitch.prototype.getList = function (index){\r\n\t//if(this.activeNum != index){ //避免多次点击\r\n\t\t\r\n    \tplus.nativeUI.showWaiting();\r\n\t\tif(index==3){\r\n\t\t\tloadrank();\r\n\t\t}else{\r\n\t\t\tloadrank(index+1);\r\n\t\t}\r\n\t//}\r\n}\r\n\r\n\r\nfunction showRank(data){\r\n\t\r\n\tvar userRank = document.querySelector('.user-rank-info');\r\n\tvar allRank = document.querySelector('.top-ten ul');\r\n\tvar showLen = 8;\r\n\t\r\n\tvar myRank = data.my,\r\n\t\tallRank = data.rank;\r\n\t\r\n\tuserRank.innerHTML ='';\r\n\tdocument.querySelector('.top-ten ul').innerHTML = '';\r\n\t\r\n\tif(allRank.length==''){\r\n\t\tdocument.querySelector('.top-ten ul').innerHTML = '<a class=\"tip\">未查询到排行数据！</a>';\r\n\t\tplus.nativeUI.closeWaiting();\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\tvar len = allRank.length;\r\n\t\r\n\tvar myphone = myRank.phone,\r\n\t\tmyscore = myRank.sum_score,\r\n\t\tmyrank = myRank.rank;\r\n\t\r\n\tif(myRank==''){\r\n\t\tuserRank.innerHTML ='';\r\n//\t\tuserRank.innerHTML = `\r\n//\t\t\t<div class=\"rank-info\">\r\n//\t\t\t\t<a>我</a>\r\n//\t\t\t\t<a><span>${myphone}</span><span>暂无排名</span></a>\r\n//\t\t\t\t<a>0</a>\r\n//\t\t\t</div>\r\n//\t\t\t<div></div>\r\n//\t\t`;\r\n\t}else{\r\n\t\tuserRank.innerHTML = `\r\n\t\t\t<div class=\"rank-info\">\r\n\t\t\t\t<a>我</a>\r\n\t\t\t\t<a><span>${myphone}</span><span>第${myrank}名</span></a>\r\n\t\t\t\t<a>${myscore}</a>\r\n\t\t\t</div>\r\n\t\t\t<div></div>\r\n\t\t`;\r\n\t}\r\n\t\r\n\tif(allRank==''){\r\n\t\tallRank.innerHTML = '<a class=\"tip\">未查询到排行数据！</a>';\r\n\t}else{\r\n\t\tvar html='';\r\n\t\tfor (var i=0;i<8;i++) {\r\n\t\t\tif(i==len){\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tvar phone = allRank[i].phone,\r\n\t\t\t\tscore = allRank[i].sum_score;\r\n\t\t\thtml+=\t`<li>\r\n\t\t\t\t\t\t<div class=\"rank-info\">\r\n\t\t\t\t\t\t\t<a>${i+1}</a>\r\n\t\t\t\t\t\t\t<a>${phone}</a>\r\n\t\t\t\t\t\t\t<a>${score}</a>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</li>`;\r\n\t\t}\r\n\t\tdocument.querySelector('.top-ten ul').innerHTML = html;\r\n\t}\r\n\tdocument.querySelector('#rank').classList.remove('mui-hidden');\r\n\tplus.nativeUI.closeWaiting();\r\n}\r\n"]}